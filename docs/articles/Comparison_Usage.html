<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fine tuning MOEA/D configurations using MOEADr and irace • MOEADr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fine tuning MOEA/D configurations using MOEADr and irace">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MOEADr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Basic_Usage.html">Basic Usage of the MOEADr Package</a>
    </li>
    <li>
      <a href="../articles/Comparison_Usage.html">Fine tuning MOEA/D configurations using MOEADr and irace</a>
    </li>
    <li>
      <a href="../articles/Modification_Usage.html">Testing New Operators using the MOEADr Package</a>
    </li>
    <li>
      <a href="../articles/problem-definition.html">Defining Problems in the MOEADr Package</a>
    </li>
    <li>
      <a href="../articles/writing-functions-for-moeadr.html">Writing Extensions for the MOEADr Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Fine tuning MOEA/D configurations using MOEADr and irace</h1>
                        <h4 class="author">Claus Aranha, Felipe Campelo</h4>
            
            <h4 class="date">2020-02-17</h4>
      
      
      <div class="hidden name"><code>Comparison_Usage.Rmd</code></div>

    </div>

    
    
<p>For this example, we adapt the tuning protocol proposed by Bezerra <em>et al.</em> (2016)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, employing the <em>Iterated Racing</em> procedure by Lopez-Ibanez <em>et al.</em> (2016)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Using the <strong>irace</strong> package, we automatically assemble and fine-tune a MOEA/D configuration based on the components available in the <strong>MOEADr</strong> package.</p>
<div id="fine-tuning-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#fine-tuning-setup" class="anchor"></a>Fine tuning setup</h2>
<p>Ten unconstrained test problems from the CEC2009 competition<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> are used, with dimensions ranging from 20 to 60. Dimensions 30, 40 and 50 were reserved for testing, while all others were used for the training effort. To quantify the quality of the set of solutions returned by a candidate configuration we use the Inverted Generational Distance (IGD). The number of subproblems was fixed as <span class="math inline">\(100\)</span> for <span class="math inline">\(m=2\)</span> and <span class="math inline">\(150\)</span> for <span class="math inline">\(m=3\)</span><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
<p>We define a tuning budget of 20,000 runs. The possible configurations are composed from the following choices:</p>
<ul>
<li>Decomposition Strategy: SLD or Uniform;</li>
<li>Scalar Aggregation function: WT, PBI or AWB;</li>
<li>Type of neighborhood: by weights or by incumbent solutions;</li>
<li>Type of Update: Standard, Restricted, or Best Subproblem;</li>
<li>Variation Stack: See below;</li>
</ul>
<p>For every combination, the parameters of each component (e.g. <span class="math inline">\(\theta^{pbi}\)</span> for the PBI aggregation function) were also included as part of the tuning experiment. Objective scaling was employed in all cases. No constraint handling was required, and the stop criterion was set as 100,000 evaluations.</p>
<p>The variation stack was composed of three to five operators, using the following rules: the first and second operators could be any of the “traditional” operators currently available in the <strong>MOEADr</strong> package: SBX, Polynomial Mutation, Differential Mutation, and Binomial Recombination. The third operator could be any of these, or “none” (i.e., not present). The fourth operator could be either a local search operator or “none”. Finally, the variation stack always finished with the truncation repair operator (mainly to avoid errors with the implementation of the test functions). No restrictions were placed on repeats of the variation operators, and the specific conditional parameters for each operator were allowed to be tuned independently for each position in the variation stack.</p>
</div>
<div id="irace-configuration" class="section level2">
<h2 class="hasAnchor">
<a href="#irace-configuration" class="anchor"></a><strong>irace</strong> configuration</h2>
<p>Here we describe the necessary setup to run the experiment above. First, loading the necessary packages and basic configuration of <em>irace</em>. (<em>parameters.txt</em>, <em>forbidden.txt</em> and other files are only included in the source version of the <em>MOEADr</em> package)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(irace))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(parallel))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(smoof))</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MOEADr))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">scenario                &lt;-<span class="st"> </span>irace<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/irace/man/defaultScenario.html">defaultScenario</a></span>()</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">scenario<span class="op">$</span>seed           &lt;-<span class="st"> </span><span class="dv">123456</span> <span class="co"># Seed for the experiment</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">scenario<span class="op">$</span>targetRunner   &lt;-<span class="st"> "target.runner"</span> <span class="co"># Runner function (def. below)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">scenario<span class="op">$</span>forbiddenFile  &lt;-<span class="st"> "../inst/extdata/forbidden.txt"</span> <span class="co"># forbidden configs</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">scenario<span class="op">$</span>debugLevel     &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">scenario<span class="op">$</span>maxExperiments &lt;-<span class="st"> </span><span class="dv">20000</span> <span class="co"># Tuning budget</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">scenario<span class="op">$</span>testNbElites   &lt;-<span class="st"> </span><span class="dv">7</span>     <span class="co"># test all final elite configurations</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># Number of cores to be used by irace (set with caution!)</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">nc                      &lt;-<span class="st"> </span>parallel<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">scenario<span class="op">$</span>parallel       &lt;-<span class="st"> </span>nc</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># Read tunable parameter list from file</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">parameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/irace/man/readParameters.html">readParameters</a></span>(<span class="st">"../inst/extdata/parameters.txt"</span>)</a></code></pre></div>
<p>Second, it is necessary to generate the training instances based on the benchmark function implementations in package <strong>smoof</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#===============</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">### Build training instances</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">fname   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"UF_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">dims    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">20</span><span class="op">:</span><span class="dv">29</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">             <span class="dv">31</span><span class="op">:</span><span class="dv">39</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">             <span class="dv">41</span><span class="op">:</span><span class="dv">49</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">             <span class="dv">51</span><span class="op">:</span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">allfuns            &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(fname, dims, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">scenario<span class="op">$</span>instances &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(allfuns[,<span class="dv">1</span>], <span class="st">"_"</span>, allfuns[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(allfuns)){</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  <span class="kw"><a href="https://rdrr.io/r/base/assign.html">assign</a></span>(<span class="dt">x     =</span> scenario<span class="op">$</span>instances[i],</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">         <span class="dt">value =</span> <span class="kw"><a href="../reference/make_vectorized_smoof.html">make_vectorized_smoof</a></span>(<span class="dt">prob.name  =</span> <span class="st">"UF"</span>,</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">                                       <span class="dt">dimensions =</span> allfuns[i, <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">                                       <span class="dt">id         =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(allfuns[i, <span class="dv">1</span>], <span class="st">"_"</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">                                                               [[<span class="dv">1</span>]][<span class="dv">2</span>]))) }</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">### Build test instances</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">dims                   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">allfuns                &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(fname, dims, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">scenario<span class="op">$</span>testInstances &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(allfuns[,<span class="dv">1</span>], <span class="st">"_"</span>, allfuns[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(allfuns)){</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">  <span class="kw"><a href="https://rdrr.io/r/base/assign.html">assign</a></span>(<span class="dt">x     =</span> scenario<span class="op">$</span>testInstances[i],</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">         <span class="dt">value =</span> <span class="kw"><a href="../reference/make_vectorized_smoof.html">make_vectorized_smoof</a></span>(<span class="dt">prob.name  =</span> <span class="st">"UF"</span>,</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">                                       <span class="dt">dimensions =</span> allfuns[i, <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">                                       <span class="dt">id         =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(allfuns[i, <span class="dv">1</span>], <span class="st">"_"</span>)</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">                                                               [[<span class="dv">1</span>]][<span class="dv">2</span>]))) }</a></code></pre></div>
<p>Third, we need to specify the code that will generate a MOEA/D configuration based on the parameter string created by the <em>irace</em> routine:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">target.runner &lt;-<span class="st"> </span><span class="cf">function</span>(experiment, scenario){</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/force.html">force</a></span>(experiment)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  conf &lt;-<span class="st"> </span>experiment<span class="op">$</span>configuration</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  inst &lt;-<span class="st"> </span>experiment<span class="op">$</span>instance</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="co"># Assemble moead input lists</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="co">## 1. Problem</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  fdef    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(inst, <span class="dt">split =</span> <span class="st">"_"</span>))</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  uffun   &lt;-<span class="st"> </span>smoof<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/smoof/man/makeUFFunction.html">makeUFFunction</a></span>(<span class="dt">dimensions =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(fdef[<span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                                   <span class="dt">id         =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(fdef[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  fattr   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(uffun, <span class="st">"par.set"</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  problem &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name       =</span> inst,</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                  <span class="dt">xmin       =</span> fattr<span class="op">$</span>pars<span class="op">$</span>x<span class="op">$</span>lower,</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                  <span class="dt">xmax       =</span> fattr<span class="op">$</span>pars<span class="op">$</span>x<span class="op">$</span>upper,</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                  <span class="dt">m          =</span> <span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(uffun, <span class="st">"n.objectives"</span>))</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  <span class="co">## 2. Decomp</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  decomp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>decomp.name)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  <span class="cf">if</span> (problem<span class="op">$</span>m <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){ <span class="co"># &lt;-- 2 objectives</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    <span class="cf">if</span>(decomp<span class="op">$</span>name <span class="op">==</span><span class="st"> "SLD"</span>) decomp<span class="op">$</span>H &lt;-<span class="st"> </span><span class="dv">99</span> <span class="co"># &lt;-- yields N = 100</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    <span class="cf">if</span>(decomp<span class="op">$</span>name <span class="op">==</span><span class="st"> "Uniform"</span>) decomp<span class="op">$</span>N &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">  } <span class="cf">else</span> { <span class="co"># &lt;-- 3 objectives</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23">    <span class="cf">if</span>(decomp<span class="op">$</span>name <span class="op">==</span><span class="st"> "SLD"</span>) decomp<span class="op">$</span>H &lt;-<span class="st"> </span><span class="dv">16</span> <span class="co"># &lt;-- yields N = 153</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    <span class="cf">if</span>(decomp<span class="op">$</span>name <span class="op">==</span><span class="st"> "Uniform"</span>) decomp<span class="op">$</span>N &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">  }</a>
<a class="sourceLine" id="cb3-26" data-line-number="26"></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  <span class="co">## 3. Neighbors</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28">  neighbors &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name    =</span> conf<span class="op">$</span>neighbor.name,</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">                    <span class="dt">T       =</span> conf<span class="op">$</span>T,</a>
<a class="sourceLine" id="cb3-30" data-line-number="30">                    <span class="dt">delta.p =</span> conf<span class="op">$</span>delta.p)</a>
<a class="sourceLine" id="cb3-31" data-line-number="31"></a>
<a class="sourceLine" id="cb3-32" data-line-number="32">  <span class="co">## 4. Aggfun</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33">  aggfun &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>aggfun.name)</a>
<a class="sourceLine" id="cb3-34" data-line-number="34">  <span class="cf">if</span> (aggfun<span class="op">$</span>name <span class="op">==</span><span class="st"> "PBI"</span>) aggfun<span class="op">$</span>theta &lt;-<span class="st"> </span>conf<span class="op">$</span>aggfun.theta</a>
<a class="sourceLine" id="cb3-35" data-line-number="35"></a>
<a class="sourceLine" id="cb3-36" data-line-number="36">  <span class="co">## 5. Update</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37">  update &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name       =</span> conf<span class="op">$</span>update.name,</a>
<a class="sourceLine" id="cb3-38" data-line-number="38">                 <span class="dt">UseArchive =</span> conf<span class="op">$</span>UseArchive)</a>
<a class="sourceLine" id="cb3-39" data-line-number="39">  <span class="cf">if</span> (update<span class="op">$</span>name <span class="op">!=</span><span class="st"> "standard"</span>) update<span class="op">$</span>nr &lt;-<span class="st"> </span>conf<span class="op">$</span>nr</a>
<a class="sourceLine" id="cb3-40" data-line-number="40">  <span class="cf">if</span> (update<span class="op">$</span>name <span class="op">==</span><span class="st"> "best"</span>)     update<span class="op">$</span>Tr &lt;-<span class="st"> </span>conf<span class="op">$</span>Tr</a>
<a class="sourceLine" id="cb3-41" data-line-number="41"></a>
<a class="sourceLine" id="cb3-42" data-line-number="42">  <span class="co">## 6. Scaling</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43">  scaling &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> <span class="st">"simple"</span>)</a>
<a class="sourceLine" id="cb3-44" data-line-number="44"></a>
<a class="sourceLine" id="cb3-45" data-line-number="45">  <span class="co">## 7. Constraint</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46">  constraint&lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb3-47" data-line-number="47"></a>
<a class="sourceLine" id="cb3-48" data-line-number="48">  <span class="co">## 8. Stop criterion</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49">  stopcrit  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name    =</span> <span class="st">"maxeval"</span>,</a>
<a class="sourceLine" id="cb3-50" data-line-number="50">                         <span class="dt">maxeval =</span> <span class="dv">100000</span>))</a>
<a class="sourceLine" id="cb3-51" data-line-number="51"></a>
<a class="sourceLine" id="cb3-52" data-line-number="52">  <span class="co">## 9. Echoing</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53">  showpars  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">show.iters =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb3-54" data-line-number="54"></a>
<a class="sourceLine" id="cb3-55" data-line-number="55">  <span class="co">## 10. Variation stack</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56">  variation &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>varop1),</a>
<a class="sourceLine" id="cb3-57" data-line-number="57">                    <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>varop2),</a>
<a class="sourceLine" id="cb3-58" data-line-number="58">                    <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>varop3),</a>
<a class="sourceLine" id="cb3-59" data-line-number="59">                    <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> conf<span class="op">$</span>varop4),</a>
<a class="sourceLine" id="cb3-60" data-line-number="60">                    <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> <span class="st">"truncate"</span>))</a>
<a class="sourceLine" id="cb3-61" data-line-number="61"></a>
<a class="sourceLine" id="cb3-62" data-line-number="62">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(variation)){</a>
<a class="sourceLine" id="cb3-63" data-line-number="63">    <span class="cf">if</span> (variation[[i]]<span class="op">$</span>name <span class="op">==</span><span class="st"> "binrec"</span>) {</a>
<a class="sourceLine" id="cb3-64" data-line-number="64">      variation[[i]]<span class="op">$</span>rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"binrec.rho"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-65" data-line-number="65">    }</a>
<a class="sourceLine" id="cb3-66" data-line-number="66">    <span class="cf">if</span> (variation[[i]]<span class="op">$</span>name <span class="op">==</span><span class="st"> "diffmut"</span>) {</a>
<a class="sourceLine" id="cb3-67" data-line-number="67">      variation[[i]]<span class="op">$</span>basis &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"diffmut.basis"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-68" data-line-number="68">      variation[[i]]<span class="op">$</span>Phi   &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb3-69" data-line-number="69">    }</a>
<a class="sourceLine" id="cb3-70" data-line-number="70">    <span class="cf">if</span> (variation[[i]]<span class="op">$</span>name <span class="op">==</span><span class="st"> "polymut"</span>) {</a>
<a class="sourceLine" id="cb3-71" data-line-number="71">      variation[[i]]<span class="op">$</span>etam &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"polymut.eta"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-72" data-line-number="72">      variation[[i]]<span class="op">$</span>pm   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"polymut.pm"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-73" data-line-number="73">    }</a>
<a class="sourceLine" id="cb3-74" data-line-number="74">    <span class="cf">if</span> (variation[[i]]<span class="op">$</span>name <span class="op">==</span><span class="st"> "sbx"</span>) {</a>
<a class="sourceLine" id="cb3-75" data-line-number="75">      variation[[i]]<span class="op">$</span>etax &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sbx.eta"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-76" data-line-number="76">      variation[[i]]<span class="op">$</span>pc   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sbx.pc"</span>, i), conf)</a>
<a class="sourceLine" id="cb3-77" data-line-number="77">    }</a>
<a class="sourceLine" id="cb3-78" data-line-number="78">    <span class="cf">if</span> (variation[[i]]<span class="op">$</span>name <span class="op">==</span><span class="st"> "localsearch"</span>) {</a>
<a class="sourceLine" id="cb3-79" data-line-number="79">      variation[[i]]<span class="op">$</span>type     &lt;-<span class="st"> </span>conf<span class="op">$</span>ls.type</a>
<a class="sourceLine" id="cb3-80" data-line-number="80">      variation[[i]]<span class="op">$</span>gamma.ls &lt;-<span class="st"> </span>conf<span class="op">$</span>gamma.ls</a>
<a class="sourceLine" id="cb3-81" data-line-number="81">    }</a>
<a class="sourceLine" id="cb3-82" data-line-number="82">  }</a>
<a class="sourceLine" id="cb3-83" data-line-number="83"></a>
<a class="sourceLine" id="cb3-84" data-line-number="84">  <span class="co">## 11. Seed</span></a>
<a class="sourceLine" id="cb3-85" data-line-number="85">  seed &lt;-<span class="st"> </span>conf<span class="op">$</span>seed</a>
<a class="sourceLine" id="cb3-86" data-line-number="86">  </a>
<a class="sourceLine" id="cb3-87" data-line-number="87">  <span class="co"># Run MOEA/D</span></a>
<a class="sourceLine" id="cb3-88" data-line-number="88">  out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/moead.html">moead</a></span>(<span class="dt">preset =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb3-89" data-line-number="89">               problem, decomp,  aggfun, neighbors, variation, update,</a>
<a class="sourceLine" id="cb3-90" data-line-number="90">               constraint, scaling, stopcrit, showpars, seed)</a>
<a class="sourceLine" id="cb3-91" data-line-number="91"></a>
<a class="sourceLine" id="cb3-92" data-line-number="92">  <span class="co"># return IGD based on reference data</span></a>
<a class="sourceLine" id="cb3-93" data-line-number="93">  Yref &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"../inst/extdata/pf_data/"</span>,</a>
<a class="sourceLine" id="cb3-94" data-line-number="94">                                      fdef[<span class="dv">1</span>], fdef[<span class="dv">2</span>], <span class="st">".dat"</span>)))</a>
<a class="sourceLine" id="cb3-95" data-line-number="95">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cost =</span> <span class="kw"><a href="../reference/calcIGD.html">calcIGD</a></span>(<span class="dt">Y =</span> out<span class="op">$</span>Y, <span class="dt">Yref =</span> Yref)))</a>
<a class="sourceLine" id="cb3-96" data-line-number="96">}</a></code></pre></div>
<p>Finally, we run the experiment, and save the outputs. Note that this experiment will take a long time to run (24 hours in a 24 cluster machine), so take that into account when reproducing these results. For more details on the code above, check the documentation of the <strong>irace</strong> package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## Running the experiment</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">irace.output &lt;-<span class="st"> </span>irace<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/irace/man/irace.html">irace</a></span>(scenario, parameters)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(irace.output, <span class="st">"../inst/extdata/RESULTS.rds"</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> <span class="st">"irace.Rdata"</span>, <span class="dt">to =</span> <span class="st">"../inst/extdata/irace-tuning.Rdata"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">## Test returned configurations on test instances</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/pkg/irace/man/testing.main.html">testing.main</a></span>(<span class="dt">logFile =</span> <span class="st">"../inst/extdata/irace-tuning.Rdata"</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="dt">from =</span> <span class="st">"irace.Rdata"</span>, <span class="dt">to =</span> <span class="st">"../inst/extdata/irace-testing.Rdata"</span>)</a></code></pre></div>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<p>First let’s plot the IGD value achieved by the final configurations over the test problems:</p>
<pre><code>## Loading required package: reshape2</code></pre>
<pre><code>## Using Problem, Dimension, Objectives as id variables</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<p><img src="Comparison_Usage_files/figure-html/reshape2,%20ggplot2-1.png" width="672"></p>
<p>The final MOEA/D configuration obtained by this experiment is described in the table below. The best configuration is presented in the first two columns. The third column, together with the figure following, provides the consensus value of each component, measured as the rate of occurrence of each component in the seven final configurations returned by the Iterated Racing procedure. These results suggest that the automated assembling and tuning method reached a reasonably solid consensus, in terms of the components used as well as the values returned for the numeric parameters.</p>
<table class="table">
<colgroup>
<col width="37%">
<col width="25%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th><strong>Component</strong></th>
<th><strong>Value</strong></th>
<th><strong>Consensus</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Decomposition</td>
<td>SLD</td>
<td>1.00</td>
</tr>
<tr class="even">
<td>Aggregation Function</td>
<td>AWT</td>
<td>1.00</td>
</tr>
<tr class="odd">
<td>Objective Scaling</td>
<td>simple</td>
<td>Fixed</td>
</tr>
<tr class="even">
<td>Neighborhood</td>
<td>by <span class="math inline">\(x\)</span><br><span class="math inline">\(T = 11\)</span><br><span class="math inline">\(\delta_p = 0.909\)</span>
</td>
<td>1.00<br>see Figure<br>see Figure</td>
</tr>
<tr class="odd">
<td>Variation Stack (1)</td>
<td>Differential Mutation<br><span class="math inline">\(basis = "rand"\)</span><br><span class="math inline">\(\phi \sim U(0,1)\)</span>
</td>
<td>1.00<br>1.00<br>Fixed</td>
</tr>
<tr class="even">
<td>Variation Stack (2)</td>
<td>Binomial Recombination<br><span class="math inline">\(\rho_1 = 0.495\)</span>
</td>
<td>
<br>1.00<br>see Figure</td>
</tr>
<tr class="odd">
<td>Variation Stack (3)</td>
<td>Binomial Recombination<br><span class="math inline">\(\rho_2 = 0.899\)</span>
</td>
<td>
<br>1.00<br>see Figure</td>
</tr>
<tr class="even">
<td>Variation Stack (4)</td>
<td>Truncate</td>
<td>Fixed</td>
</tr>
<tr class="odd">
<td>Update</td>
<td>Restricted<br><span class="math inline">\(nr=1\)</span>
</td>
<td>1.00<br>1.00</td>
</tr>
</tbody>
</table>
<pre><code>## Plotting: T</code></pre>
<pre><code>## Plotting: delta.p</code></pre>
<pre><code>## Plotting: binrec.rho2</code></pre>
<pre><code>## Plotting: binrec.rho3</code></pre>
<p><img src="Comparison_Usage_files/figure-html/ggplot2-1.png" width="672"></p>
<p>A feature that may seem surprising at first glance is the two sequential applications of Binomial Recombination in the Variation Stack. This means that the results of a Differential Mutation operator are recombined with the incumbent solutions at the (reasonably low) recombination rate <span class="math inline">\(\rho_1 = 0.495\)</span>; and then the resulting vectors are again recombined with the incumbent solutions, at a (much higher) rate <span class="math inline">\(\rho_2 = 0.899\)</span>. However, a quick review of the definition of Binomial Recombination and some elementary probability shows that these two sequential applications of binomial recombinations can be expressed as a single application with <span class="math inline">\(\rho = \rho_1\rho_2 = 0.445\)</span>. The fact that Iterated Racing converged to two operators instead of a single one can be explained by the fact that these situations are equivalent, coupled with the absence of any pressure towards more parsimonious expressions of the Variation Stack in the setup.</p>
<p>Another seemingly counter intuitive aspect of the final configurations reached is the absence of local search. A possible explanation lies in the interaction between the variation operators chosen (differential mutation + binomial recombination) with the type of neighborhood (by <span class="math inline">\(x\)</span>, with a very strong bias towards using points from the neighborhood for the variant operators - <span class="math inline">\(\delta_p = 0.909\)</span>). The use of points that are relatively similar in the space of decision variables may result in local exploration in this case, since the magnitude of the differential vectors tends to become relatively small. As the iterations progress, this Variation Stack would tend to perform local search movements, with larger pertubations potentially occurring whenever points are sampled from outside the neighborhoods (i.e., about 10% of the cases). It is therefore possible that this local exploration characteristic may have resulted in a MOEA/D configuration that does not benefit from an explicit local search operator.</p>
<p>Besides these considerations, the configurations returned by the Iterated Racing procedure present a few other interesting points. First, the use of a smaller neighborhood than is usually practiced in the literature (T = 11), with the neighborhood relations being defined at each iteration by the similarities between the incumbent solutions of each subproblem. Second, the use of a very strict Restricted Neighborhood Update, with <span class="math inline">\(n_r = 1\)</span>, which suggests an advantage in trying to maintain diversity instead of accelerating convergence. The use of the variation operators of the MOEAD/D-De <em>without</em> Polynomial Mutation (as is usually practiced in the MOEA/D-DE) is also curious, as it may indicate a more parsimonious variation stack than is usually practiced in the literature.</p>
</div>
<div id="recommendations" class="section level2">
<h2 class="hasAnchor">
<a href="#recommendations" class="anchor"></a>Recommendations</h2>
<p>As can be seen, exploring the space of possible component configurations and parameter values can render improved algorithmic configurations and new insights into the roles of specific components and parameter values.</p>
<p>Thus, we highly recommend that a similar approach is used when developing new components, in order to observe not only the individual performance of the novel component, but also its interaction with components which already exist in the MOEA/D environment.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Lecture Notes in Computer Science 9018:48–63, 2016.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Operations Research Perspectives 3:43-58, 2016<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Functions UF1 to UF10 (<a href="https://web.archive.org/web/20180129060104/https://dces.essex.ac.uk/staff/qzhang/MOEAcompetition/CEC09final/">https://web.archive.org/web/20180129060104/https://dces.essex.ac.uk/staff/qzhang/MOEAcompetition/CEC09final</a>), using the standard implementation available in the <strong>smoof</strong> package.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>For the Simplex Lattice Design the actual number was 153 for <span class="math inline">\(m = 3\)</span>, given the specifics of this method. Please refer to the documentation of function <em>decomposition_sld()</em> for details<a href="#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fine-tuning-setup">Fine tuning setup</a></li>
      <li><a href="#irace-configuration"><strong>irace</strong> configuration</a></li>
      <li><a href="#results">Results</a></li>
      <li><a href="#recommendations">Recommendations</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Felipe Campelo, Claus Aranha.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
